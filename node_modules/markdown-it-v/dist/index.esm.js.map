{"version":3,"file":"index.esm.js","sources":["../src/cross-create-element.js","../src/stream-dom.js","../src/renderer.js","../src/index.js"],"sourcesContent":["export function createElementVueFactory(h) {\n  return function createElementVue(tagName, attrs, innerHTML, children) {\n    const arg2 = { attrs }\n    if (innerHTML != null) {\n      arg2.domProps = { innerHTML }\n    }\n    return h(tagName, arg2, children)\n  }\n}\n\nexport function createElementReactFactory(h) {\n  return function createElementReact(tagName, attrs, innerHTML, children) {\n    const arg2 = { ...attrs }\n    if (innerHTML != null) {\n      arg2.dangerouslySetInnerHTML = { __html: innerHTML }\n    }\n    if (typeof arg2.style === 'string') {\n      const styleString = arg2.style\n      delete arg2.style\n      arg2.ref = elem => elem.setAttribute('style', styleString)\n    }\n    return h(tagName, arg2, ...children)\n  }\n}\n\nexport function createElementNativeFactory(document) {\n  return function createElementNative(tagName, attrs, innerHTML, children) {\n    const el = document.createElement(tagName)\n    for (const [key, value] of Object.entries(attrs)) {\n      el.setAttribute(key, value)\n    }\n    if (innerHTML != null) {\n      el.innerHTML = innerHTML\n    }\n    for (const child of children) {\n      el.appendChild(\n        typeof child === 'string' ? document.createTextNode(child) : child,\n      )\n    }\n    return el\n  }\n}\n","import { escapeHtml } from 'markdown-it/lib/common/utils'\nimport * as crossCreateElement from './cross-create-element'\nimport _ from 'lodash'\n\nconst voidElements = [\n  'base',\n  'link',\n  'meta',\n  'hr',\n  'br',\n  'img',\n  'embed',\n  'param',\n  'source',\n  'area',\n  'col',\n  'input',\n  'command',\n]\n\nexport const voidTag = Symbol('void')\n\nexport class Node {\n  constructor(tagName, attrs = {}, parent = null, ...children) {\n    this.tagName = tagName\n    this.attrs =\n      Object.entries(attrs).filter(([key, value]) => key !== '__html')\n      |> _.fromPairs\n    this.innerHTML = attrs.__html\n    this.parent = parent\n    this.children = children\n  }\n  renderAttrsToHTML() {\n    return Object.entries(this.attrs)\n      .map(([key, value]) => `${escapeHtml(key)}=\"${escapeHtml(value)}\"`)\n      .join(' ')\n  }\n  renderInnerHTML(xhtmlOut = false) {\n    if (voidElements.includes(this.tagName)) {\n      return ''\n    } else if (this.innerHTML == null) {\n      return this.children\n        .map(child =>\n          typeof child === 'string'\n            ? escapeHtml(child)\n            : child.renderToHTML(xhtmlOut),\n        )\n        .join('')\n    } else {\n      return this.innerHTML\n    }\n  }\n  renderToHTML(xhtmlOut = false) {\n    if (this.tagName === voidTag) {\n      return this.renderInnerHTML(xhtmlOut)\n    }\n    const attrsString = this.renderAttrsToHTML()\n    let result = '<' + this.tagName\n    if (attrsString) {\n      result += ' ' + attrsString\n    }\n    if (voidElements.includes(this.tagName)) {\n      if (xhtmlOut) {\n        result += ' />'\n      } else {\n        result += '>'\n      }\n    } else {\n      result += '>'\n      result += this.renderInnerHTML(xhtmlOut)\n      result += `</${this.tagName}>`\n    }\n    return result\n  }\n  renderInnerVDOM(h) {\n    return (\n      this.children.map(child =>\n        typeof child === 'string' ? child : child.renderToVDOM(h),\n      ) |> _.flatten\n    )\n  }\n  renderToVDOM(h) {\n    if (this.tagName === voidTag) {\n      if (this.innerHTML != null) {\n        throw new Error('`void` tag cannot contain innerHTML')\n      }\n      return this.renderInnerVDOM(h)\n    } else {\n      return h(\n        this.tagName,\n        this.attrs,\n        this.innerHTML,\n        this.renderInnerVDOM(h),\n      )\n    }\n  }\n  dropParent() {\n    this.parent = null\n  }\n  dropParents() {\n    this.dropParent()\n    this.children\n      .filter(el => typeof el !== 'string')\n      .forEach(el => el.dropParents())\n  }\n}\n\nexport default class StreamDom {\n  currentNode = new Node(voidTag)\n  xhtmlOut = false\n  openTag(tagName, attrs) {\n    const newNode = new Node(tagName, attrs, this.currentNode)\n    this.currentNode.children.push(newNode)\n    this.currentNode = newNode\n  }\n  closeTag() {\n    this.currentNode = this.currentNode.parent\n  }\n  appendText(text) {\n    this.currentNode.children.push(text)\n  }\n  toHTML(xhtmlOut = this.xhtmlOut) {\n    return this.currentNode.renderToHTML(xhtmlOut)\n  }\n  toVue(createElement) {\n    return this.currentNode.renderToVDOM(\n      crossCreateElement.createElementVueFactory(createElement),\n    )\n  }\n  toReact(createElement) {\n    return this.currentNode.renderToVDOM(\n      crossCreateElement.createElementReactFactory(createElement),\n    )\n  }\n  toNative(document) {\n    return this.currentNode\n      .renderToVDOM(crossCreateElement.createElementNativeFactory(document))\n      .map(el => (typeof el === 'string' ? document.createTextNode(el) : el))\n  }\n}\n","import { default as StreamDom, voidTag } from './stream-dom'\nimport OriginalRenderer from 'markdown-it/lib/renderer'\nimport { unescapeAll } from 'markdown-it/lib/common/utils'\nimport _ from 'lodash'\n\nconst default_rules = {\n  text(tokens, idx, options, env, slf) {\n    slf.sDom.appendText(tokens[idx].content)\n    return slf.sDom\n  },\n  code_inline(tokens, idx, options, env, slf) {\n    const token = tokens[idx]\n    slf.sDom.openTag('code', slf.renderAttrs(token))\n    slf.sDom.appendText(token.content)\n    slf.sDom.closeTag()\n    return slf.sDom\n  },\n  code_block(tokens, idx, options, env, slf) {\n    const token = tokens[idx]\n    slf.sDom.openTag('pre', slf.renderAttrs(token))\n    slf.sDom.openTag('code')\n    slf.sDom.appendText(token.content)\n    slf.sDom.closeTag()\n    slf.sDom.closeTag()\n    slf.sDom.appendText('\\n')\n    return slf.sDom\n  },\n  fence(tokens, idx, options, env, slf) {\n    const token = tokens[idx]\n    const info = token.info ? unescapeAll(token.info).trim() : ''\n    const langName = info ? info.split(/\\s+/g)[0] : ''\n    const attrs = slf.renderAttrs(token)\n    function addClass(classString, className) {\n      if (classString == null || classString === '') {\n        return className\n      } else {\n        return `${classString} ${className}`\n      }\n    }\n    if (info) {\n      attrs['class'] = addClass(attrs['class'], options.langPrefix + langName)\n    }\n    if (!options.highlightNoWrappingEls) {\n      slf.sDom.openTag('pre')\n      slf.sDom.openTag('code', attrs)\n    }\n    const highlighted = options.highlight?.(token.content, langName, slf)\n    if (highlighted === slf.sDom) {\n      // Processed\n    } else if (\n      typeof highlighted === 'string' &&\n      !options.highlightNoWrappingEls\n    ) {\n      // When highlight function returns a string with highlightNoWrappingEls on,\n      // fence can be nothing more than just text.\n      slf.sDom.closeTag()\n      slf.sDom.currentNode.children.pop()\n      slf.sDom.openTag('code', { ...attrs, __html: highlighted })\n    } else {\n      slf.sDom.appendText(token.content)\n    }\n    if (!options.highlightNoWrappingEls) {\n      slf.sDom.closeTag()\n      slf.sDom.closeTag()\n    }\n    slf.sDom.appendText('\\n')\n    return slf.sDom\n  },\n  hardbreak(tokens, idx, options, env, slf) {\n    slf.sDom.openTag('br')\n    slf.sDom.closeTag()\n    slf.sDom.appendText('\\n')\n  },\n  softbreak(tokens, idx, options, env, slf) {\n    if (options.breaks) {\n      this.hardbreak(tokens, idx, options, env, slf)\n    } else {\n      slf.sDom.appendText('\\n')\n    }\n  },\n  html_block(tokens, idx, options, env, slf) {\n    slf.sDom.openTag(voidTag, { __html: tokens[idx].content })\n    slf.sDom.closeTag()\n  },\n  html_inline(tokens, idx, options, env, slf) {\n    slf.sDom.openTag(voidTag, { __html: tokens[idx].content })\n    slf.sDom.closeTag()\n  },\n}\n\nexport default class Renderer extends OriginalRenderer {\n  constructor() {\n    super()\n    Object.assign(this.rules, default_rules)\n    this.clear()\n  }\n  clear() {\n    this.sDom = new StreamDom()\n  }\n  renderAttrs({ attrs }) {\n    return attrs |> _.fromPairs\n  }\n  render(tokens, options, env) {\n    tokens.forEach(({ type, children }, i) => {\n      if (type === 'inline') {\n        this.renderInline(children, options, env)\n      } else if (typeof this.rules[type] !== 'undefined') {\n        this.rules[type](tokens, i, options, env, this)\n      } else {\n        this.renderToken(tokens, i, options, env)\n      }\n    })\n    return this.sDom\n  }\n  renderInline(tokens, options, env) {\n    tokens.forEach(({ type }, i) => {\n      if (typeof this.rules[type] !== 'undefined') {\n        this.rules[type](tokens, i, options, env, this)\n      } else {\n        this.renderToken(tokens, i, options)\n      }\n    })\n    return this.sDom\n  }\n  renderToken(tokens, idx, options) {\n    const token = tokens[idx]\n    const { tag: tagName, nesting, hidden, block } = token\n    if (!hidden) {\n      if (block && nesting !== -1 && idx && tokens[idx - 1].hidden) {\n        this.sDom.appendText('\\n')\n      }\n      if (nesting < 0) {\n        this.sDom.closeTag()\n      } else {\n        const attrs = this.renderAttrs(token)\n        this.sDom.openTag(tagName, attrs)\n        if (nesting === 0) {\n          this.sDom.closeTag()\n        }\n      }\n      let needLf = false\n      if (block) {\n        needLf = true\n        if (nesting === 1) {\n          if (idx + 1 < tokens.length) {\n            const nextToken = tokens[idx + 1]\n            if (nextToken.type === 'inline' || nextToken.hidden) {\n              needLf = false\n            } else if (\n              nextToken.nesting === -1 &&\n              nextToken.tag === token.tag\n            ) {\n              needLf = false\n            }\n          }\n        }\n      }\n      if (needLf) {\n        this.sDom.appendText('\\n')\n      }\n    }\n    return this.sDom\n  }\n}\n","import Renderer from './renderer'\n\nexport default md => {\n  md.renderer = new Renderer()\n  const render = md.render\n  const renderInline = md.renderInline\n  md.render = function(...args) {\n    const result = render.apply(this, args)\n    if (this.renderer instanceof Renderer) {\n      this.renderer.clear()\n      result.xhtmlOut = md.options.xhtmlOut\n    }\n    return result\n  }\n  md.renderInline = function(...args) {\n    const result = renderInline.apply(this, args)\n    if (this.renderer instanceof Renderer) {\n      this.renderer.clear()\n      result.xhtmlOut = md.options.xhtmlOut\n    }\n    return result\n  }\n}\n"],"names":["createElementVueFactory","h","createElementVue","tagName","attrs","innerHTML","children","arg2","domProps","createElementReactFactory","createElementReact","dangerouslySetInnerHTML","__html","style","styleString","ref","elem","setAttribute","createElementNativeFactory","document","createElementNative","el","createElement","Object","entries","key","value","child","appendChild","createTextNode","voidElements","voidTag","Symbol","Node","parent","filter","map","escapeHtml","join","xhtmlOut","includes","renderToHTML","renderInnerHTML","attrsString","renderAttrsToHTML","result","renderToVDOM","Error","renderInnerVDOM","dropParent","forEach","dropParents","StreamDom","newNode","currentNode","push","text","crossCreateElement","default_rules","tokens","idx","options","env","slf","sDom","appendText","content","code_inline","token","openTag","renderAttrs","closeTag","code_block","fence","info","unescapeAll","trim","langName","split","addClass","classString","className","langPrefix","highlightNoWrappingEls","highlighted","highlight","pop","hardbreak","softbreak","breaks","html_block","html_inline","Renderer","assign","rules","clear","i","type","renderInline","renderToken","tag","nesting","hidden","block","needLf","length","nextToken","OriginalRenderer","md","renderer","render","args","apply"],"mappings":"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"}